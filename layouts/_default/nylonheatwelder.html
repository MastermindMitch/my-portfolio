{{ define "main" }}
<style>
  /* ===== Force Full-Width Layout ===== */
  main {
    width: 100vw !important;
    max-width: 100vw !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  /* ===== Page Layout ===== */
  .project-container {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: flex-start;
    flex-wrap: wrap;
    width: 100vw;
    box-sizing: border-box;
    padding: 3rem 6rem;
    font-family: "Inter", sans-serif;
    line-height: 1.6;
    color: #e0e0e0;
  }

  /* ===== Project Title ===== */
  .project-title {
    width: 100%;
    color: #ff4b4b;
    font-size: 2.2rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-weight: 800;
    margin-bottom: 1rem;
    text-align: center;
  }

  /* ===== Left Text Section ===== */
  .details {
    flex: 1 1 55%;
    background-color: #1a1a1a;
    padding: 2rem;
    border-radius: 16px;
    margin-right: 2rem;
    box-sizing: border-box;
  }

  .details p {
    margin: 0.6rem 0;
  }

  .details strong {
    color: #ff4b4b;
    font-weight: 700;
    margin-right: 0.3rem;
  }

  /* ===== Right Image Section ===== */
  .robot-image {
    flex: 1 1 35%;
    text-align: center;
  }

  .robot-image img {
    width: 100%;
    max-width: 1000px;
    height: 400px;
    object-fit: cover; /* crops top and bottom */
    border-radius: 16px;
    box-shadow: 0 0 10px rgba(0,0,0,0.6);
  }

  /* ===== Video Section ===== */
  .video-section {
    width: 70%;
    margin: 2.5rem auto;
    box-sizing: border-box;
  }

  .video-section h2 {
    color: #ff4b4b;
    font-size: 1.3rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border-bottom: 1px solid #333;
    padding-bottom: 0.3rem;
    margin-bottom: 0.8rem;
  }

  .video-wrapper {
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 0 8px rgba(0,0,0,0.6);
  }

  video {
    display: block;
    width: 100%;
    height: auto;
    max-height: 75vh;
    border-radius: 12px;
    background: #000;
    object-fit: contain;
  }

  .video-description {
    color: #b0b0b0;
    font-size: 0.95rem;
    font-style: italic;
    margin-top: 0.6rem;
    line-height: 1.5;
    text-align: left;
  }

  /* ===== Responsive ===== */
  @media (max-width: 1000px) {
    .project-container {
      flex-direction: column;
      padding: 2rem;
    }

    .details {
      margin-right: 0;
      margin-bottom: 2rem;
    }

    .robot-image {
      flex: 1 1 auto;
      margin-bottom: 2rem;
    }

    .video-section {
      width: 90%;
    }
  }
</style>

<div class="project-container">
  <h1 class="project-title">{{ .Title }}</h1>

  <div class="details">
    <p><strong>What:</strong>A machine designed to heat weld two rods of extruded nylon into one continuous piece. The nylon rods are stored on four-foot drums, which naturally give them a curved profile.</p>

    <p><strong>How:</strong>A belt, shaped to match the nylon's curvature, was used to move the nylon. Pneumatic actuators maintain consistent pressure, holding the nylon firmly against the belt during motion.</p>

    <p><strong>Result:</strong>A working proof of concept for the movement mechanism, the most challenging aspect, was constructed. The nylon did not deform under the pneumatics. Operators could easily insert material through the front of the machine.</p>

    <p><strong>CAD:</strong>Inventor</p>
  </div>

  <div class="robot-image">
    <img src="/images/NylonHeatWelderThumbnail.jpg" alt="Nylon Heat Welder">
  </div>
</div>

<div class="video-section">
  <h2>Heat Welder Demonstration</h2>
  <div class="video-wrapper">
    <video controls muted preload="metadata" loop playsinline>
      <source src="/videos/NylonHeatWelderDemoFixed3.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
  </div>
  <p class="video-description">
    Here I'm demonstrating how to use the machine.
  </p>
</div>

<div class="video-section">
  <h2>Back of the Machine</h2>
  <div class="video-wrapper">
    <video controls muted preload="metadata" loop playsinline>
      <source src="/videos/NylonHeatWelderBacksideFixed2.webm" type="video/webm">
      <source src="/videos/NylonHeatWelderBacksideFixed2.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
  </div>
  <p class="video-description">
    A view of the pneumatics from the backside.
  </p>
</div>

<script>
/* ========== Only Play the Closest Video ========== */
document.addEventListener("DOMContentLoaded", () => {
  const videos = document.querySelectorAll("video");

  const playClosest = () => {
    let closestVideo = null;
    let closestDistance = Infinity;

    videos.forEach(video => {
      const rect = video.getBoundingClientRect();
      const videoCenter = rect.top + rect.height / 2;
      const screenCenter = window.innerHeight / 2;
      const distance = Math.abs(videoCenter - screenCenter);

      if (distance < closestDistance) {
        closestDistance = distance;
        closestVideo = video;
      }
    });

    videos.forEach(v => {
      if (v === closestVideo && closestDistance < window.innerHeight / 2) {
        v.play();
      } else {
        v.pause();
      }
    });
  };

  window.addEventListener("scroll", playClosest);
  window.addEventListener("resize", playClosest);
  playClosest();
});
</script>
{{ end }}

